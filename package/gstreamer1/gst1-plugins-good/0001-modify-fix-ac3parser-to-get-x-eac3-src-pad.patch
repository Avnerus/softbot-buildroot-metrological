From 38b7c0dab9c3d5a25b87cf8fef1fe30def3c9038 Mon Sep 17 00:00:00 2001
From: yaozenhu <yaozenhu@realtek.com>
Date: Thu, 22 Sep 2016 17:10:39 +0800
Subject: [PATCH 1/3] [modify] fix ac3parser to get x-eac3 src-pad

Change-Id: If35cb6136d49c16ff35ce9c0e92177f0143a6659
---
 gst/audioparsers/gstac3parse.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/gst/audioparsers/gstac3parse.c b/gst/audioparsers/gstac3parse.c
index 875f9cb..0a2dc9b 100644
--- a/gst/audioparsers/gstac3parse.c
+++ b/gst/audioparsers/gstac3parse.c
@@ -637,9 +637,11 @@ gst_ac3_parse_handle_frame (GstBaseParse * parse,
       goto cleanup;
   }
 
+  eac = ac3parse->eac; //FIXME
+
   if (G_UNLIKELY (ac3parse->sample_rate != rate || ac3parse->channels != chans
           || ac3parse->eac != eac)) {
-    GstCaps *caps = gst_caps_new_simple (eac ? "audio/x-eac3" : "audio/x-ac3",
+    GstCaps *caps = gst_caps_new_simple (ac3parse->eac ? "audio/x-eac3" : "audio/x-ac3",
         "framed", G_TYPE_BOOLEAN, TRUE, "rate", G_TYPE_INT, rate,
         "channels", G_TYPE_INT, chans, NULL);
     gst_caps_set_simple (caps, "alignment", G_TYPE_STRING,
@@ -951,5 +953,8 @@ gst_ac3_parse_set_sink_caps (GstBaseParse * parse, GstCaps * caps)
   } else {
     gst_pad_set_chain_function (parse->sinkpad, ac3parse->baseparse_chainfunc);
   }
+
+  if(gst_structure_has_name (s, "audio/x-eac3"))
+	ac3parse->eac = TRUE;
   return TRUE;
 }
-- 
2.7.4

